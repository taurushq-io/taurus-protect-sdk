syntax = "proto3";
package tgvalidatord;

import "google/protobuf/timestamp.proto";
import "protoc-gen-openapiv2/options/annotations.proto";

option java_package = "com.taurushq.sdk.protect.proto.v1";

message Score {
  uint64 id = 1;
  string provider = 2;
  string type = 3;
  string score = 4;
  google.protobuf.Timestamp updateDate = 5;
}

message TransactionScore {
  string id = 1;
  string provider = 2;
  string type = 3;
  string score = 4;
  google.protobuf.Timestamp updateDate = 5;
}

message ScoreFilter {
  message ScorechainFilters {
    option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
      json_schema: {
        description: "The risk score of Scorechain is between 0 (highest risk, bad) to 100 (lowest risk, good)."
      }
    };
    string scoreInBelow = 1 [
      (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
        description: "Filter addresses under a Scorechain incoming score threshold.";
      }
    ];
    string scoreOutBelow = 2 [
      (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
        description: "Filter addresses under a Scorechain outgoing score threshold.";
      }
    ];
    bool scoreExclusive = 3 [
      (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
        description: "By default when both Scorechain scores scoreInBelow and scoreOutBelow are"
            " provided, it returns the addresses matching (scoreInBelow AND scoreOutBelow)."
            " When scoreExclusive is set to true, it will return the addresses"
            " matching (scoreInBelow OR scoreOutBelow).";
      }
    ];
  }
  message CoinfirmFilters {
    option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
      json_schema: {
        description: "The c-score of Coinfirm is between 0 (lowest risk, good) to 100 (highest risk, bad)."
      }
    };
    string scoreGreater = 1 [
      (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
        description: "Filter addresses with a Coinfirm C-score above threshold.";
      }
    ];
  }
  message ChainalysisFilters {
    option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
      json_schema: {
        description: "The risk score of Chainalysis is between 0 (lowest risk, good) to 100 (highest risk, bad)."
      }
    };
    string scoreGreater = 1 [
      (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
        description: "Filter addresses with a Chainalysis risk score above threshold.";
      }
    ];
  }
  message EllipticFilters {
    option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
      json_schema: {
        description: "The risk score of Elliptic is between 0 (lowest risk, good) to 100 (highest risk, bad)."
      }
    };
    string scoreGreater = 1 [
      (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
        description: "Filter addresses with an Elliptic risk score above threshold.";
      }
    ];
  }
  message TRMLabsFilters {
    option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
      json_schema: {
        description: "The risk score of TRM Labs is between 0 (lowest risk, good) to 100 (highest risk, bad)."
      }
    };
    string scoreGreater = 1 [
      (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
        description: "Filter addresses with an TRM Labs risk score above threshold.";
      }
    ];
  }

  string scoreProvider = 1 [
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      description: "Specify the score provider to filter on, or empty."
          "Each provider has associated filter parameters that can be set."
          "Supported values: `scorechain`, `coinfirm`, `chainalysis`, `elliptic`, `trmlabs`";
    }
  ];
  ScorechainFilters scorechainFilters = 2;
  CoinfirmFilters coinfirmFilters = 3;
  ChainalysisFilters chainalysisFilters = 4;
  EllipticFilters ellipticFilters = 5;
  TRMLabsFilters trmlabsFilters = 6;
}
