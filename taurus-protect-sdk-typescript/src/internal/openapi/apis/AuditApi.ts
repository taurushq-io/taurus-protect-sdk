/* tslint:disable */
/* eslint-disable */
/**
 * Taurus-PROTECT APIs
 * Taurus-PROTECT APIs description
 *
 * The version of the OpenAPI document: 1.0
 * 
 *
 * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).
 * https://openapi-generator.tech
 * Do not edit the class manually.
 */


import * as runtime from '../runtime';
import type {
  GooglerpcStatus,
  TgvalidatordExportAuditTrailsReply,
  TgvalidatordGetAuditTrailsReply,
} from '../models/index';
import {
    GooglerpcStatusFromJSON,
    GooglerpcStatusToJSON,
    TgvalidatordExportAuditTrailsReplyFromJSON,
    TgvalidatordExportAuditTrailsReplyToJSON,
    TgvalidatordGetAuditTrailsReplyFromJSON,
    TgvalidatordGetAuditTrailsReplyToJSON,
} from '../models/index';

export interface AuditServiceExportAuditTrailsRequest {
    externalUserId?: string;
    entities?: Array<string>;
    actions?: Array<string>;
    creationDateFrom?: Date;
    creationDateTo?: Date;
    format?: string;
}

export interface AuditServiceGetAuditTrailsRequest {
    externalUserId?: string;
    entities?: Array<string>;
    actions?: Array<string>;
    creationDateFrom?: Date;
    creationDateTo?: Date;
    cursorCurrentPage?: string;
    cursorPageRequest?: string;
    cursorPageSize?: string;
    sortingSortBy?: Array<string>;
    sortingSortOrder?: string;
}

/**
 * AuditApi - interface
 * 
 * @export
 * @interface AuditApiInterface
 */
export interface AuditApiInterface {
    /**
     * This endpoint exports a list of audit trails as CSV. Note that only a maximum of 10000 trails are exportable at any one time.
     * @summary Export audit trails
     * @param {string} [externalUserId] 
     * @param {Array<string>} [entities] The entities for which to get audit trails (defaults to all).
     * @param {Array<string>} [actions] The actions for which to get audit trails (defaults to all).
     * @param {Date} [creationDateFrom] 
     * @param {Date} [creationDateTo] 
     * @param {string} [format] Desired output format. Can be either \&#39;csv\&#39; or \&#39;json\&#39;.
     * @param {*} [options] Override http request option.
     * @throws {RequiredError}
     * @memberof AuditApiInterface
     */
    auditServiceExportAuditTrailsRaw(requestParameters: AuditServiceExportAuditTrailsRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<TgvalidatordExportAuditTrailsReply>>;

    /**
     * This endpoint exports a list of audit trails as CSV. Note that only a maximum of 10000 trails are exportable at any one time.
     * Export audit trails
     */
    auditServiceExportAuditTrails(requestParameters: AuditServiceExportAuditTrailsRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<TgvalidatordExportAuditTrailsReply>;

    /**
     * This endpoint returns audit trails for the given tenant, entities, actions, and date range.
     * @summary Get audit trails
     * @param {string} [externalUserId] 
     * @param {Array<string>} [entities] The entities for which to get audit trails (defaults to all).
     * @param {Array<string>} [actions] The actions for which to get audit trails (defaults to all).
     * @param {Date} [creationDateFrom] 
     * @param {Date} [creationDateTo] 
     * @param {string} [cursorCurrentPage] Base64-encoded string representing the current window of data
     * @param {string} [cursorPageRequest] The page to request, w.r.t the current page. Can be one of &#x60;FIRST&#x60;, &#x60;PREVIOUS&#x60;, &#x60;NEXT&#x60;, &#x60;LAST&#x60;
     * @param {string} [cursorPageSize] The size of the page requested. The handling service should impose a hard limit on this
     * @param {Array<string>} [sortingSortBy] The columns to order by. Can be &#x60;CreationDate&#x60; (default)
     * @param {string} [sortingSortOrder] Can be &#x60;DESC&#x60; (default), &#x60;ASC&#x60;
     * @param {*} [options] Override http request option.
     * @throws {RequiredError}
     * @memberof AuditApiInterface
     */
    auditServiceGetAuditTrailsRaw(requestParameters: AuditServiceGetAuditTrailsRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<TgvalidatordGetAuditTrailsReply>>;

    /**
     * This endpoint returns audit trails for the given tenant, entities, actions, and date range.
     * Get audit trails
     */
    auditServiceGetAuditTrails(requestParameters: AuditServiceGetAuditTrailsRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<TgvalidatordGetAuditTrailsReply>;

}

/**
 * 
 */
export class AuditApi extends runtime.BaseAPI implements AuditApiInterface {

    /**
     * This endpoint exports a list of audit trails as CSV. Note that only a maximum of 10000 trails are exportable at any one time.
     * Export audit trails
     */
    async auditServiceExportAuditTrailsRaw(requestParameters: AuditServiceExportAuditTrailsRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<TgvalidatordExportAuditTrailsReply>> {
        const queryParameters: any = {};

        if (requestParameters['externalUserId'] != null) {
            queryParameters['externalUserId'] = requestParameters['externalUserId'];
        }

        if (requestParameters['entities'] != null) {
            queryParameters['entities'] = requestParameters['entities'];
        }

        if (requestParameters['actions'] != null) {
            queryParameters['actions'] = requestParameters['actions'];
        }

        if (requestParameters['creationDateFrom'] != null) {
            queryParameters['creationDateFrom'] = (requestParameters['creationDateFrom'] as any).toISOString();
        }

        if (requestParameters['creationDateTo'] != null) {
            queryParameters['creationDateTo'] = (requestParameters['creationDateTo'] as any).toISOString();
        }

        if (requestParameters['format'] != null) {
            queryParameters['format'] = requestParameters['format'];
        }

        const headerParameters: runtime.HTTPHeaders = {};

        if (this.configuration && this.configuration.apiKey) {
            headerParameters["Authorization"] = await this.configuration.apiKey("Authorization"); // ApiKeyTPV1 authentication
        }

        const response = await this.request({
            path: `/api/rest/v1/audit_trails/export`,
            method: 'GET',
            headers: headerParameters,
            query: queryParameters,
        }, initOverrides);

        return new runtime.JSONApiResponse(response, (jsonValue) => TgvalidatordExportAuditTrailsReplyFromJSON(jsonValue));
    }

    /**
     * This endpoint exports a list of audit trails as CSV. Note that only a maximum of 10000 trails are exportable at any one time.
     * Export audit trails
     */
    async auditServiceExportAuditTrails(requestParameters: AuditServiceExportAuditTrailsRequest = {}, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<TgvalidatordExportAuditTrailsReply> {
        const response = await this.auditServiceExportAuditTrailsRaw(requestParameters, initOverrides);
        return await response.value();
    }

    /**
     * This endpoint returns audit trails for the given tenant, entities, actions, and date range.
     * Get audit trails
     */
    async auditServiceGetAuditTrailsRaw(requestParameters: AuditServiceGetAuditTrailsRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<TgvalidatordGetAuditTrailsReply>> {
        const queryParameters: any = {};

        if (requestParameters['externalUserId'] != null) {
            queryParameters['externalUserId'] = requestParameters['externalUserId'];
        }

        if (requestParameters['entities'] != null) {
            queryParameters['entities'] = requestParameters['entities'];
        }

        if (requestParameters['actions'] != null) {
            queryParameters['actions'] = requestParameters['actions'];
        }

        if (requestParameters['creationDateFrom'] != null) {
            queryParameters['creationDateFrom'] = (requestParameters['creationDateFrom'] as any).toISOString();
        }

        if (requestParameters['creationDateTo'] != null) {
            queryParameters['creationDateTo'] = (requestParameters['creationDateTo'] as any).toISOString();
        }

        if (requestParameters['cursorCurrentPage'] != null) {
            queryParameters['cursor.currentPage'] = requestParameters['cursorCurrentPage'];
        }

        if (requestParameters['cursorPageRequest'] != null) {
            queryParameters['cursor.pageRequest'] = requestParameters['cursorPageRequest'];
        }

        if (requestParameters['cursorPageSize'] != null) {
            queryParameters['cursor.pageSize'] = requestParameters['cursorPageSize'];
        }

        if (requestParameters['sortingSortBy'] != null) {
            queryParameters['sorting.sortBy'] = requestParameters['sortingSortBy'];
        }

        if (requestParameters['sortingSortOrder'] != null) {
            queryParameters['sorting.sortOrder'] = requestParameters['sortingSortOrder'];
        }

        const headerParameters: runtime.HTTPHeaders = {};

        if (this.configuration && this.configuration.apiKey) {
            headerParameters["Authorization"] = await this.configuration.apiKey("Authorization"); // ApiKeyTPV1 authentication
        }

        const response = await this.request({
            path: `/api/rest/v1/audit_trails`,
            method: 'GET',
            headers: headerParameters,
            query: queryParameters,
        }, initOverrides);

        return new runtime.JSONApiResponse(response, (jsonValue) => TgvalidatordGetAuditTrailsReplyFromJSON(jsonValue));
    }

    /**
     * This endpoint returns audit trails for the given tenant, entities, actions, and date range.
     * Get audit trails
     */
    async auditServiceGetAuditTrails(requestParameters: AuditServiceGetAuditTrailsRequest = {}, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<TgvalidatordGetAuditTrailsReply> {
        const response = await this.auditServiceGetAuditTrailsRaw(requestParameters, initOverrides);
        return await response.value();
    }

}
