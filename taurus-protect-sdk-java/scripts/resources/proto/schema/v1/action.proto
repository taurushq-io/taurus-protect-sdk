syntax = "proto3";
package tgvalidatord;

import "google/protobuf/timestamp.proto";

option java_package = "com.taurushq.sdk.protect.proto.v1";

message ActionEnvelope {
  message Trail {
    uint64 id = 1;
    string action = 2;
    string comment = 3;
    google.protobuf.Timestamp date = 4;
    string actionStatus = 5;
  }

  uint64 id = 1;
  uint64 tenantId = 2;
  string label = 3;
  Action action = 4;
  string status = 5;
  google.protobuf.Timestamp creationDate = 6;
  google.protobuf.Timestamp updateDate = 7;
  google.protobuf.Timestamp lastcheckeddate = 8;
  bool autoApprove = 9;
  repeated ActionAttribute attributes = 10;
  repeated Trail trails = 11;
}

// when <trigger> then perform <actions>
message Action {
  message Trigger {
    enum Kind {
      None = 0;
      Balance = 1;
    }
    message _Balance {
      Target target = 1;
      Comparator comparator = 2;
      Amount amount = 3;
    }
    string kind = 1;
    _Balance balance = 2;
  }

  message Source {
    enum Kind {
      None = 0;
      AddressID = 1;
      WalletID = 2;
    }
    string kind = 1;
    uint64 addressID = 2;
    uint64 walletID = 3;
  }

  message Destination {
    enum Kind {
      None = 0;
      AddressID = 1;
      WhitelistedAddressID = 2;
      WalletID = 3;
    }
    string kind = 1;
    uint64 addressID = 2;
    uint64 whitelistedAddressID = 3;
    uint64 walletID = 4;
  }

  message Target {
    enum Kind {
      None = 0;
      Address = 1;
      Wallet = 2;
    }
    message _Address {
      enum Kind {
        _None = 0;
        AddressID = 1;
      }
      string kind = 1;
      uint64 addressID = 2;

    }
    message _Wallet {
      enum Kind {
        __None = 0;
        WalletID = 1;
      }
      string kind = 1;
      uint64 walletID = 2;
    }
    string kind = 1;
    _Address address = 2;
    _Wallet wallet = 3;
  }


  message Comparator {
    enum Kind {
      None = 0;
      GreaterThan = 1;
      LowerThan = 2;
    }
    string kind = 1;
  }

  message Amount {
    enum Kind {
      None = 0;
      CryptoAmount = 1;
    }
    string kind = 1;
    string cryptoAmount = 2;
  }

  message Task {
    enum Kind {
      None = 0;
      Transfer = 1;
      Notification = 2;
    }
    message _Transfer {
      Source from = 1;
      Destination to = 2;
      Amount amount = 3;
      bool topUp = 4;
      bool useAllFunds = 5;
    }

    message _Notification {
      repeated string emailAddresses = 1;
      string notificationMessage = 2;
      uint64 numberOfReminders = 3;
    }
    string kind = 1;
    _Transfer transfer = 2;
    _Notification notification = 3;
  }
  Trigger trigger = 1;
  repeated Task tasks = 2;
}

message ActionAttribute{
  uint64 id = 1;
  uint64 tenantId = 2;
  string key = 3;
  string value = 4;
  string contentType = 5;
}




