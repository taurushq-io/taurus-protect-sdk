syntax = "proto3";
package tgvalidatord;

import "google/protobuf/timestamp.proto";
import "cursor.proto";
import "google/api/annotations.proto";
import "protoc-gen-openapiv2/options/annotations.proto";
import "google/api/visibility.proto";

option java_package = "com.taurushq.sdk.protect.proto.v1";

message Workflow {
  option (google.api.message_visibility).restriction = "INTERNAL";
  string id = 1;
  uint64 tenantID = 2;
  string status = 3;
  google.protobuf.Timestamp createdAt = 4;
  google.protobuf.Timestamp updatedAt = 5;
  google.protobuf.Timestamp scheduledFor = 6;
  string reservedBy = 7;
  google.protobuf.Timestamp reservedUntil = 8;
  string workflowType = 9;
  string workflowPayload = 10;
  string state = 11;
}

message WorkflowTrail {
  option (google.api.message_visibility).restriction = "INTERNAL";
  string id = 1;
  uint64 tenantID = 2;
  string workflowID = 3;
  string eventID = 4;
  string workflowAction = 5;
  repeated string emittedEventsIDs = 6;
  repeated string createdWorkflowsIDs = 7;
  WorkflowActionResult workflowActionResult = 8;
  string workflowStateLabelBefore = 9;
  string workflowStateLabelAfter = 10;
  google.protobuf.Timestamp createdAt = 11;
}

message WorkflowError {
  option (google.api.message_visibility).restriction = "INTERNAL";
  string message = 1;
  string errorCode = 2;
  string errorID = 3;
}

message WorkflowActionResult {
  option (google.api.message_visibility).restriction = "INTERNAL";
  enum ResultType {
    none = 0;
    success = 1;
    error = 2;
  }
  ResultType type = 1;
  oneof result {
    WorkflowError errorResult = 2;
  };
}